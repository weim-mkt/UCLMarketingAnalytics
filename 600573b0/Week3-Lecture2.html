<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr Wei Miao">
<meta name="dcterms.date" content="2022-10-20">

<title>Marketing Analytics - Class 7 Predictive Analytics for STP (I): Unsupervised Learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Week3-Lecture2.pdf" rel="next">
<link href="./Week3-Lecture1.pdf" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FTK61TBF7L"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-FTK61TBF7L', { 'anonymize_ip': true});
</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Class 7 Predictive Analytics for STP (I): Unsupervised Learning</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Marketing Analytics</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle sidebar-tool" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Lectures</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./syllabus.html" class="sidebar-item-text sidebar-link">Syllabus</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ClassPreparation.html" class="sidebar-item-text sidebar-link">Weekly Arrangements</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">[Week 1] Marketing Process and Break-Even Analyses</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week1-Lecture1.html" class="sidebar-item-text sidebar-link">Class 1 Intro to Marketing (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week1-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 1 Intro to Marketing (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week1-Lecture2.html" class="sidebar-item-text sidebar-link">Class 2 Break-Even Analyses (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week1-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 2 Break-Even Analyses (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-BreakEvenAnalysis.html" class="sidebar-item-text sidebar-link">Break-Even Analyses for PineApple Inc (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-BreakEvenAnalysis.pdf" class="sidebar-item-text sidebar-link">Break-Even Analyses for PineApple Inc (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ClassExercise.html" class="sidebar-item-text sidebar-link">In-Class Exercise Solutions</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">[Week 2] Customer Lifetime Value and Data Wrangling with R</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week2-Lecture1.html" class="sidebar-item-text sidebar-link">Class 3 Customer Lifetime Value Case Study (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week2-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 3 Customer Lifetime Value Case Study (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week2-Lecture2.html" class="sidebar-item-text sidebar-link">Class 4 Data Wrangling with R I (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week2-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 4 Data Wrangling with R I (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-CLSV.html" class="sidebar-item-text sidebar-link">CLSV Solutions</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">[Week 3] Unsupervised Learning and Customer Segmentation</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week3-Lecture1.html" class="sidebar-item-text sidebar-link">Class 5 Data Wrangling with R II (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week3-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 5 Data Wrangling with R II (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week3-Lecture2.html" class="sidebar-item-text sidebar-link active">Class 6 Unsupervised Learning (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week3-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 6 Unsupervised Learning (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-PreliminaryCustomerAnalysis-stu.pdf" class="sidebar-item-text sidebar-link">Preliminary Customer Analyses</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-PreliminaryCustomerAnalysis.html" class="sidebar-item-text sidebar-link">Case Solution: Descriptive Analytics</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">[Week 4] Supervised Learning and Customer Targeting</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week4-Lecture1.html" class="sidebar-item-text sidebar-link">Class 7 Supervised Learning (html)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week4-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 7 Supervised Learning (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week4-Lecture2.html" class="sidebar-item-text sidebar-link">Class 8: Improve Marketing Efficiency Using Predictive Analytics (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week4-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 8: Improve Marketing Efficiency Using Predictive Analytics (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-PredictiveAnalytics-stu.pdf" class="sidebar-item-text sidebar-link">Improving Marketing Efficiency Using Predictive Analytics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-PredictiveAnalytics.html" class="sidebar-item-text sidebar-link">Case Solution: Predictive Analytics</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">[Week 5] Causal Inference and RCT</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week5-Lecture1.html" class="sidebar-item-text sidebar-link">Class 9 Causal Inference (html)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week5-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 9 Causal Inference (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week5-Lecture2.html" class="sidebar-item-text sidebar-link">Class 10 Randomized Controlled Trials (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week5-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 10 Randomized Controlled Trials (PDF)</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">[Week 6] Linear Regression Models</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week6-Lecture1.html" class="sidebar-item-text sidebar-link">Class 11 Application of A-B Testing at Vungle (html)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week6-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 11 Application of A-B Testing at Vungle (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week6-Lecture2.html" class="sidebar-item-text sidebar-link">Class 12 Linear Regression Basics (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week6-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 12 Linear Regression Basics (PDF)</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">[Week 7] Marketing Mix Modeling</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week7-Lecture1.html" class="sidebar-item-text sidebar-link">Class 13 Linear Regression Advanced (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week7-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 13 Linear Regression Advanced (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week7-Lecture2.html" class="sidebar-item-text sidebar-link">Class 14 Marketing Mix Modeling (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week7-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 14 Marketing Mix Modeling (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-Zalora.html" class="sidebar-item-text sidebar-link">Case Solution: Zalora</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">[Week 8] Endogeneity and Instrumental Variable</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week8-Lecture1.html" class="sidebar-item-text sidebar-link">Class 15 Endogeneity (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week8-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 15 Endogeneity (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week8-Lecture2.html" class="sidebar-item-text sidebar-link">Class 16 Instrumental Variable (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week8-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 16 Instrumental Variable (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-COVID-IV-stu.pdf" class="sidebar-item-text sidebar-link">Case: COVID-19 and Ridesharing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Case-COVID-IV.html" class="sidebar-item-text sidebar-link">Case Solution: COVID-19 and Ridesharing</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">[Week 9] Natural Experiment</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week9-Lecture1.html" class="sidebar-item-text sidebar-link">Class 17 Difference-in-Differences (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week9-Lecture1.pdf" class="sidebar-item-text sidebar-link">Class 17 Difference-in-Differences (PDF)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week9-Lecture2.html" class="sidebar-item-text sidebar-link">Class 18 Regression Discontinuity Design (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week9-Lecture2.pdf" class="sidebar-item-text sidebar-link">Class 18 Regression Discontinuity Design (PDF)</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">[Week 10] Module Wrap-Up</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week10-Lecture2.html" class="sidebar-item-text sidebar-link">Week 10 Module Wrap-Up (HTML)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Week10-Lecture2.pdf" class="sidebar-item-text sidebar-link">Week 10 Module Wrap-Up (PDF)</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">R Tutorials</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-installR.html" class="sidebar-item-text sidebar-link">Install and Setup R</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">R Basics Part I (Induction Week)</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-InductionWeek.html" class="sidebar-item-text sidebar-link">html version</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-InductionWeek.pdf" class="sidebar-item-text sidebar-link">pdf version</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">R Basics Part II (Induction Week)</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-14" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-14" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-InductionWeek-II.html" class="sidebar-item-text sidebar-link">html version</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-InductionWeek-II.pdf" class="sidebar-item-text sidebar-link">pdf version</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./R-errors.html" class="sidebar-item-text sidebar-link">Troubleshooting R</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="true">Advanced R Tips</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-15" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-15" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./RTip-BLAS.html" class="sidebar-item-text sidebar-link">Speed Up Matrix Operations</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview-of-predictive-analytics" id="toc-overview-of-predictive-analytics" class="nav-link active" data-scroll-target="#overview-of-predictive-analytics"> <span class="header-section-number">1</span> Overview of Predictive Analytics</a>
  <ul class="collapse">
  <li><a href="#our-journey-so-far" id="toc-our-journey-so-far" class="nav-link" data-scroll-target="#our-journey-so-far"> <span class="header-section-number">1.1</span> Our Journey So Far</a></li>
  <li><a href="#roadmap-of-predictive-analytics" id="toc-roadmap-of-predictive-analytics" class="nav-link" data-scroll-target="#roadmap-of-predictive-analytics"> <span class="header-section-number">1.2</span> Roadmap of Predictive Analytics</a></li>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives"> <span class="header-section-number">1.3</span> Learning Objectives</a></li>
  </ul></li>
  <li><a href="#predictive-analytics" id="toc-predictive-analytics" class="nav-link" data-scroll-target="#predictive-analytics"> <span class="header-section-number">2</span> Predictive Analytics</a>
  <ul class="collapse">
  <li><a href="#types-of-predictive-analytics" id="toc-types-of-predictive-analytics" class="nav-link" data-scroll-target="#types-of-predictive-analytics"> <span class="header-section-number">2.1</span> Types of Predictive Analytics</a></li>
  <li><a href="#types-of-predictive-analytics-1" id="toc-types-of-predictive-analytics-1" class="nav-link" data-scroll-target="#types-of-predictive-analytics-1"> <span class="header-section-number">2.2</span> Types of Predictive Analytics</a></li>
  </ul></li>
  <li><a href="#segmentation-with-unsupervised-learning" id="toc-segmentation-with-unsupervised-learning" class="nav-link" data-scroll-target="#segmentation-with-unsupervised-learning"> <span class="header-section-number">3</span> Segmentation with Unsupervised Learning</a>
  <ul class="collapse">
  <li><a href="#customer-segmentation" id="toc-customer-segmentation" class="nav-link" data-scroll-target="#customer-segmentation"> <span class="header-section-number">3.1</span> Customer Segmentation</a></li>
  <li><a href="#conventional-ways-for-customer-segmentation" id="toc-conventional-ways-for-customer-segmentation" class="nav-link" data-scroll-target="#conventional-ways-for-customer-segmentation"> <span class="header-section-number">3.2</span> Conventional Ways for Customer Segmentation</a></li>
  <li><a href="#commonly-used-clustering-algorithms" id="toc-commonly-used-clustering-algorithms" class="nav-link" data-scroll-target="#commonly-used-clustering-algorithms"> <span class="header-section-number">3.3</span> Commonly Used Clustering Algorithms</a></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering"> <span class="header-section-number">3.4</span> K-Means Clustering</a></li>
  <li><a href="#k-means-clustering-intuition" id="toc-k-means-clustering-intuition" class="nav-link" data-scroll-target="#k-means-clustering-intuition"> <span class="header-section-number">3.5</span> K-Means Clustering: Intuition</a></li>
  <li><a href="#implementation-of-k-means-in-r-for-tesco" id="toc-implementation-of-k-means-in-r-for-tesco" class="nav-link" data-scroll-target="#implementation-of-k-means-in-r-for-tesco"> <span class="header-section-number">3.6</span> Implementation of K-Means in R for Tesco</a></li>
  <li><a href="#implementation-of-k-means-in-r-for-tesco-1" id="toc-implementation-of-k-means-in-r-for-tesco-1" class="nav-link" data-scroll-target="#implementation-of-k-means-in-r-for-tesco-1"> <span class="header-section-number">3.7</span> Implementation of K-Means in R for Tesco</a></li>
  <li><a href="#implementation-of-k-means-in-r-for-tesco-2" id="toc-implementation-of-k-means-in-r-for-tesco-2" class="nav-link" data-scroll-target="#implementation-of-k-means-in-r-for-tesco-2"> <span class="header-section-number">3.8</span> Implementation of K-Means in R for Tesco</a></li>
  <li><a href="#implementation-of-k-means-in-r-for-tesco-3" id="toc-implementation-of-k-means-in-r-for-tesco-3" class="nav-link" data-scroll-target="#implementation-of-k-means-in-r-for-tesco-3"> <span class="header-section-number">3.9</span> Implementation of K-Means in R for Tesco</a></li>
  <li><a href="#implementation-of-k-means-in-r-for-tesco-4" id="toc-implementation-of-k-means-in-r-for-tesco-4" class="nav-link" data-scroll-target="#implementation-of-k-means-in-r-for-tesco-4"> <span class="header-section-number">3.10</span> Implementation of K-Means in R for Tesco</a></li>
  <li><a href="#implementation-of-k-means-in-r-for-tesco-5" id="toc-implementation-of-k-means-in-r-for-tesco-5" class="nav-link" data-scroll-target="#implementation-of-k-means-in-r-for-tesco-5"> <span class="header-section-number">3.11</span> Implementation of K-Means in R for Tesco</a></li>
  <li><a href="#implementation-of-k-means-in-r-for-tesco-6" id="toc-implementation-of-k-means-in-r-for-tesco-6" class="nav-link" data-scroll-target="#implementation-of-k-means-in-r-for-tesco-6"> <span class="header-section-number">3.12</span> Implementation of K-Means in R for Tesco</a></li>
  <li><a href="#pros-and-cons-of-k-means-clustering" id="toc-pros-and-cons-of-k-means-clustering" class="nav-link" data-scroll-target="#pros-and-cons-of-k-means-clustering"> <span class="header-section-number">3.13</span> Pros and Cons of K-means Clustering</a></li>
  <li><a href="#after-class-readings" id="toc-after-class-readings" class="nav-link" data-scroll-target="#after-class-readings"> <span class="header-section-number">3.14</span> After-Class Readings</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Class 7 Predictive Analytics for STP (I): Unsupervised Learning</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr Wei Miao </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 20, 2022</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="overview-of-predictive-analytics" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Overview of Predictive Analytics</h1>
<section id="our-journey-so-far" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="our-journey-so-far"><span class="header-section-number">1.1</span> Our Journey So Far</h2>
<ul>
<li><p>The core of any business decision is <strong>break-even analysis</strong> (cost-benefit analysis)</p>
<ul>
<li>BEQ; NPV; CLV (Week 1 and Week 2)</li>
</ul></li>
<li><p>For better profitability management, we can work on either reducing the <strong>cost</strong> or boosting the <strong>benefit</strong>.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-361EFA3E.png" class="img-fluid figure-img" width="250"></p>
</figure>
</div>
</section>
<section id="roadmap-of-predictive-analytics" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="roadmap-of-predictive-analytics"><span class="header-section-number">1.2</span> Roadmap of Predictive Analytics</h2>
<ul>
<li>In Weeks 3 and 4, we will learn how to utilize predictive analytics to reduce marketing costs and improve marketing efficiency</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/paste-613B4ABA.png" class="img-fluid figure-img" width="400"></p>
</figure>
</div>
</section>
<section id="learning-objectives" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">1.3</span> Learning Objectives</h2>
<ul>
<li><p>Understand the concept of statistical learning</p></li>
<li><p>Understand the concept of unsupervised learning and how to apply clustering analyses for customer segmentation</p></li>
</ul>
</section>
</section>
<section id="predictive-analytics" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Predictive Analytics</h1>
<section id="types-of-predictive-analytics" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="types-of-predictive-analytics"><span class="header-section-number">2.1</span> Types of Predictive Analytics</h2>
<ul>
<li>Unsupervised Learning
<ul>
<li>Only observe X =&gt; Want to uncover unknown subgroups</li>
</ul></li>
<li>Supervised Learning
<ul>
<li>Observe both X and Y =&gt; Want to predict Y for new data</li>
</ul></li>
<li>Reinforcement Learning
<ul>
<li>Rewards and punishments =&gt; Learn the best decision rules</li>
<li><a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4146060">Dynamic Coupon Targeting Using Batch Deep Reinforcement Learning: An Application to Livestream Shopping</a></li>
</ul></li>
</ul>
<p>In Term 2, you will learn predictive analytics models systematically. By then, think about how those techniques can be applied back to these case studies.</p>
</section>
<section id="types-of-predictive-analytics-1" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="types-of-predictive-analytics-1"><span class="header-section-number">2.2</span> Types of Predictive Analytics</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/PredictiveAnalyticsTypes.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
</section>
</section>
<section id="segmentation-with-unsupervised-learning" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Segmentation with Unsupervised Learning</h1>
<section id="customer-segmentation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="customer-segmentation"><span class="header-section-number">3.1</span> Customer Segmentation</h2>
<p>Segmentation is the process of dividing customers into meaningful groups based on any characteristics relevant to design and execution of your marketing strategy. It assumes that different customer groups offer different levels of value to the company and/or require different marketing programs to succeed with (e.g., based on different goals and needs).</p>
</section>
<section id="conventional-ways-for-customer-segmentation" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="conventional-ways-for-customer-segmentation"><span class="header-section-number">3.2</span> Conventional Ways for Customer Segmentation</h2>
<ul>
<li><p><strong>Customer value segmentation</strong> is for targeting decisions based on customers’ potential long-term financial and strategic value to your company.</p></li>
<li><p><strong>Benefit segmentation</strong> is for positioning and marketing mix design on the basis of customer and consumer goals or usage, the needs, wants, problems and the trade-offs they are willing to make across benefits (e.g., price vs.&nbsp;quality).</p></li>
<li><p><strong>Psychographic segmentation</strong> is for positioning and marketing mix design based on the psychology of the customer and consumer, including attitudes, identity, lifestyle, personality, etc.</p></li>
<li><p><strong>Demographic segmentation</strong> uses variables such as age, gender, income, family life cycle, educational qualification, socio-economic status, religion, company size and income, etc. These serve as proxies for goals, preferences or psychographics, as well as to characterize segments for marketing mix decisions.</p></li>
</ul>
<p>Conventional segmentation methods require heavy human judgments. A more sensible way is to “let the data speak”.</p>
</section>
<section id="commonly-used-clustering-algorithms" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="commonly-used-clustering-algorithms"><span class="header-section-number">3.3</span> Commonly Used Clustering Algorithms</h2>
<ul>
<li>K-means clustering
<ul>
<li>The number of clusters need to be pre-speciﬁed</li>
</ul></li>
<li>Hierarchical clustering
<ul>
<li>Observations are clustered in a tree-structured graph or dendrogram. No need to pre-determine the number of clusters.</li>
</ul></li>
</ul>
</section>
<section id="k-means-clustering" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="k-means-clustering"><span class="header-section-number">3.4</span> K-Means Clustering</h2>
<p>K-means clustering is one of the most commonly used unsupervised machine learning algorithms for partitioning a given data set into a set of&nbsp;<em>k</em>&nbsp;groups (i.e.&nbsp;<em>k</em>&nbsp;clusters), where&nbsp;<em>k</em>&nbsp;represents the number of groups pre-specified by the analyst.</p>
<p>It can classify customers into multiple segments (i.e., clusters), such that customers within the same cluster are as similar as possible, whereas customers from different clusters are as dissimilar as possible.&nbsp;</p>
<ul>
<li>Input: customer data (characteristics of interest) and the number of clusters</li>
<li>Output: clusters
<ul>
<li>Let <span class="math inline">\(C_1 , C_2 , · · · , C_k\)</span> be the clusters</li>
<li>Every customer is categorized to only one of the clusters</li>
</ul></li>
</ul>
</section>
<section id="k-means-clustering-intuition" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="k-means-clustering-intuition"><span class="header-section-number">3.5</span> K-Means Clustering: Intuition</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/kmeansViz.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
</section>
<section id="implementation-of-k-means-in-r-for-tesco" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="implementation-of-k-means-in-r-for-tesco"><span class="header-section-number">3.6</span> Implementation of K-Means in R for Tesco</h2>
<ol type="1">
<li>Decide to do customer segmentation based on <em>total spending</em> and <em>income</em></li>
</ol>
<div class="cell">

</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/k-means.png" class="img-fluid figure-img" width="300"></p>
</figure>
</div>
<ul>
<li><code>x</code>: data with selected variables to apply K-means</li>
<li><code>centers</code>: number of clusters</li>
<li><code>iter.max</code>: the maximum number of iterations allowed</li>
<li><code>nstart</code>: how many random sets should be chosen</li>
<li><code>algorithm</code>: which algorithm to choose; default often works</li>
<li><code>trace</code>: do you want to trace intermediate steps?</li>
</ul>
</section>
<section id="implementation-of-k-means-in-r-for-tesco-1" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="implementation-of-k-means-in-r-for-tesco-1"><span class="header-section-number">3.7</span> Implementation of K-Means in R for Tesco</h2>
<ul>
<li><p>Need to re-scale the two variables using <code>scale()</code>, because the two variables are of very different scales</p>
<ul>
<li><strong>This is extremely important!</strong></li>
<li><code>set.seed()</code> is to allow replication of results. Refer to this data camp <a href="https://campus.datacamp.com/courses/sampling-in-r/introduction-to-sampling-1?ex=10">tutorial</a> for more details.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>data_kmeans <span class="ot">&lt;-</span> data_full<span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="fu">select</span>(Income,total_spending)<span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="fu">mutate</span>(<span class="at">Income =</span> <span class="fu">scale</span>(Income),</span>
<span id="cb1-5"><a href="#cb1-5"></a>         <span class="at">total_spending =</span> <span class="fu">scale</span>(total_spending))</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>result_kmeans <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(data_kmeans,</span>
<span id="cb1-8"><a href="#cb1-8"></a>                        <span class="at">centers =</span> <span class="dv">2</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>                        <span class="at">nstart =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="implementation-of-k-means-in-r-for-tesco-2" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="implementation-of-k-means-in-r-for-tesco-2"><span class="header-section-number">3.8</span> Implementation of K-Means in R for Tesco</h2>
<ol start="2" type="1">
<li>Examine the returned object, <code>result_kmeans</code></li>
</ol>
<div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">str</span>(result_kmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 9
 $ cluster     : int [1:2000] 1 2 1 2 2 1 2 2 2 2 ...
 $ centers     : num [1:2, 1:2] 0.95 -0.663 1.022 -0.713
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:2] "1" "2"
  .. ..$ : chr [1:2] "Income" "total_spending"
 $ totss       : num 3998
 $ withinss    : num [1:2] 726 553
 $ tot.withinss: num 1280
 $ betweenss   : num 2718
 $ size        : int [1:2] 822 1178
 $ iter        : int 1
 $ ifault      : int 0
 - attr(*, "class")= chr "kmeans"</code></pre>
</div>
</div>
</div>
<ul>
<li><p><code>cluster</code>: A vector of integers (from 1:k) indicating the cluster to which each point is allocated.</p></li>
<li><p><code>centers</code>: A matrix of cluster centers.</p></li>
<li><p><code>totss</code>: The total sum of squares.</p></li>
<li><p><code>withinss</code>: Vector of within-cluster sum of squares, one component per cluster.</p></li>
<li><p><code>tot.withinss</code>: Total within-cluster sum of squares, i.e.&nbsp;sum(withinss).</p></li>
<li><p><code>betweenss</code>: The between-cluster sum of squares, i.e.&nbsp;$totss-tot.withinss$.</p></li>
<li><p><code>size</code>: The number of points in each cluster.</p></li>
</ul>
</section>
<section id="implementation-of-k-means-in-r-for-tesco-3" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="implementation-of-k-means-in-r-for-tesco-3"><span class="header-section-number">3.9</span> Implementation of K-Means in R for Tesco</h2>
<ol start="3" type="1">
<li>Visualize the clusters
<ul>
<li><p>We need 2 packages <code>cluster</code> and <code>factoextra</code></p></li>
<li><p>Use <code>fviz_cluster()</code> to generate visualizations</p></li>
</ul></li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(cluster,factoextra)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="fu">fviz_cluster</span>(result_kmeans,</span>
<span id="cb4-4"><a href="#cb4-4"></a>             <span class="at">data =</span> data_kmeans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Week3-Lecture2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="implementation-of-k-means-in-r-for-tesco-4" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="implementation-of-k-means-in-r-for-tesco-4"><span class="header-section-number">3.10</span> Implementation of K-Means in R for Tesco</h2>
<ol start="4" type="1">
<li>Determine the optimal number of clusters using statistical criteria</li>
</ol>
<ul>
<li><strong>Gap</strong> Method</li>
</ul>
<div class="cell" data-layout-align="center" data-hash="Week3-Lecture2_cache/html/unnamed-chunk-6_60cc27fced9cb424f1714ad7cdf8ec90">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>gap_stat <span class="ot">&lt;-</span> <span class="fu">clusGap</span>(data_kmeans, </span>
<span id="cb5-3"><a href="#cb5-3"></a>                    <span class="at">FUN =</span> kmeans,</span>
<span id="cb5-4"><a href="#cb5-4"></a>                    <span class="at">K.max =</span> <span class="dv">10</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>                    <span class="at">B =</span> <span class="dv">50</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">fviz_gap_stat</span>(gap_stat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Week3-Lecture2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="implementation-of-k-means-in-r-for-tesco-5" class="level2" data-number="3.11">
<h2 data-number="3.11" class="anchored" data-anchor-id="implementation-of-k-means-in-r-for-tesco-5"><span class="header-section-number">3.11</span> Implementation of K-Means in R for Tesco</h2>
<ol start="4" type="1">
<li>Determine the optimal number of clusters using statistical criteria</li>
</ol>
<ul>
<li><strong>Silhouette</strong> method</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">set.seed</span>(<span class="dv">888</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="fu">fviz_nbclust</span>(data_kmeans, kmeans, <span class="at">method =</span> <span class="st">"silhouette"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Week3-Lecture2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="implementation-of-k-means-in-r-for-tesco-6" class="level2" data-number="3.12">
<h2 data-number="3.12" class="anchored" data-anchor-id="implementation-of-k-means-in-r-for-tesco-6"><span class="header-section-number">3.12</span> Implementation of K-Means in R for Tesco</h2>
<ol start="5" type="1">
<li>Compare the CLV in the two segments, and decide which segment to serve.
<ul>
<li>This is a general idea of segmentation and targeting using unsupervised learning</li>
<li>Finish this exercise after class</li>
</ul></li>
</ol>
</section>
<section id="pros-and-cons-of-k-means-clustering" class="level2" data-number="3.13">
<h2 data-number="3.13" class="anchored" data-anchor-id="pros-and-cons-of-k-means-clustering"><span class="header-section-number">3.13</span> Pros and Cons of K-means Clustering</h2>
<p><strong>Advantages</strong></p>
<ul>
<li><p>Easy to implement and explain</p></li>
<li><p>Computationally eﬃcient</p></li>
</ul>
<p><strong>Drawbacks</strong></p>
<ul>
<li><p>As the number of variable increases, curse of dimensionality problem occurs</p></li>
<li><p>Sensitive to outliers and initial seeds</p></li>
</ul>
</section>
<section id="after-class-readings" class="level2" data-number="3.14">
<h2 data-number="3.14" class="anchored" data-anchor-id="after-class-readings"><span class="header-section-number">3.14</span> After-Class Readings</h2>
<ul>
<li>Useful source: <a href="https://uc-r.github.io/kmeans_clustering">K-means Cluster Analysis</a></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="./Week3-Lecture1.pdf" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Class 5 Data Wrangling with R II (PDF)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Week3-Lecture2.pdf" class="pagination-link">
        <span class="nav-page-text">Class 6 Unsupervised Learning (PDF)</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>